# 分布式锁

## etcd 分布式锁实现

### 竞争锁资源
多个客户端进行同一任务竞争资源时，通过`watch`命令监听同一`key`，如果对应的键值发生变化（理解为超时删除），则使用`mk`尝试创建新的`key`，如果已存在则创建失败，成功则表明该客户端竞争到资源。

步骤：
1. etcdctl watch key -f
	- 监测一个键值的变化
2. etcdctl mk key "Hello world "--ttl '5'
	- 尝试创建键值，并指定5秒的超时时间
	- 成功：键不存在则创建新的键
	- 失败：Error:  105: Key already exists (/key) [68]
